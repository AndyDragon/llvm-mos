# RUN: llc -mtriple=mos -run-pass=instruction-select -verify-machineinstrs -o - %s | FileCheck %s
---
name: and
# CHECK-LABEL: name: and
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(s8) = COPY $a
    %2:any(s8) = G_AND %0, %1
    RTS implicit %2
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %1:imag8 = COPY $a
# CHECK-NEXT: %2:ac = ANDImag8 %0, %1
# CHECK-NEXT: RTS
...
---
name: asl
# CHECK-LABEL: name: asl
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s1) = G_CONSTANT i1 0
    %2:any(s8), %3:any(s1) = G_SHLE %0, %1
    RTS implicit %2, implicit %3
# CHECK:      %0:aimag8 = COPY $a
# CHECK-NEXT: %2:aimag8, %3:cc = ASL %0
# CHECK-NEXT: RTS
...
---
name: anyext_8_1
# CHECK-LABEL: name: anyext_8_1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = COPY $c
    %1:any(s8) = G_ANYEXT %0
    RTS implicit %1
# CHECK:      %2:anyi8 = IMPLICIT_DEF
# CHECK:      %3:anyi8 = INSERT_SUBREG %2, %0, %subreg.sublsb
# CHECK-NEXT: RTS implicit %3
...
---
name: anyext_16_8
# CHECK-LABEL: name: anyext_16_8
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s16) = G_ANYEXT %0
    RTS implicit %1
# CHECK:      %2:imag16 = IMPLICIT_DEF
# CHECK:      %3:imag16 = INSERT_SUBREG %2, %0, %subreg.sublo
# CHECK-NEXT: RTS implicit %3
...
---
name: anyext_16_1
# CHECK-LABEL: name: anyext_16_1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = COPY $c
    %1:any(s16) = G_ANYEXT %0
    RTS implicit %1
# CHECK:      %2:anyi8 = IMPLICIT_DEF
# CHECK:      %3:anyi8 = INSERT_SUBREG %2, %0, %subreg.sublsb
# CHECK:      %4:imag16 = IMPLICIT_DEF
# CHECK:      %5:imag16 = INSERT_SUBREG %4, %3, %subreg.sublo
# CHECK-NEXT: RTS implicit %5
...
---
name: br_imm
# CHECK-LABEL: name: br_imm
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = COPY $c
    G_BRCOND_IMM %0, %bb.0, 0
    RTS
# CHECK:      %1:cc = CMPImm %0, 0
# CHECK-NEXT: BR %bb.0, $z, 1
...
---
name: cmpimm_brc
# CHECK-LABEL: name: cmpimm_brc
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s8) = G_CONSTANT i8 42
    %2:any(s1), %3:any(s1), %4:any(s1), %5:any(s1) = G_CMP %0, %1
    G_BRCOND_IMM %2, %bb.0, 1
    RTS
# CHECK:      %6:cc = CMPImm %0, 42
# CHECK-NEXT: BR %bb.0, %6, 1
...
---
name: cmpimm_brn
# CHECK-LABEL: name: cmpimm_brn
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s8) = G_CONSTANT i8 42
    %2:any(s1), %3:any(s1), %4:any(s1), %5:any(s1) = G_CMP %0, %1
    G_BRCOND_IMM %3, %bb.0, 1
    RTS
# CHECK:      %6:cc = CMPImm %0, 42
# CHECK-NEXT: BR %bb.0, $n, 1
...
---
name: cmpimm_brz
# CHECK-LABEL: name: cmpimm_brz
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s8) = G_CONSTANT i8 42
    %2:any(s1), %3:any(s1), %4:any(s1), %5:any(s1) = G_CMP %0, %1
    G_BRCOND_IMM %5, %bb.0, 1
    RTS
# CHECK:      %6:cc = CMPImm %0, 42
# CHECK-NEXT: BR %bb.0, $z, 1
...
---
name: cmp
# CHECK-LABEL: name: cmp
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s8) = G_CONSTANT i8 42
    %2:any(s1), %3:any(s1), %4:any(s1), %5:any(s1) = G_CMP %0, %1
    RTS implicit %2, implicit %3, implicit %4, implicit %5
# CHECK:      %8:gpr = LDImm 42
# CHECK-NEXT: %1:imag8 = COPY %8
# CHECK-NEXT: %6:cc = LDCImm 1
# CHECK-NEXT: %7:ac, %2:cc, %3:anyi1, %4:vc, %5:anyi1 = SBCNZImag8 %0, %1, %6
# CHECK-NEXT: RTS
...
---
name: copy
# CHECK-LABEL: name: copy
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    liveins: $a
    %0:any(s8) = COPY $a
    RTS implicit %0
# CHECK: %0:anyi8 = COPY $a
...
---
name: eor
# CHECK-LABEL: name: eor
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(s8) = COPY $a
    %2:any(s8) = G_XOR %0, %1
    RTS implicit %2
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %1:imag8 = COPY $a
# CHECK-NEXT: %2:ac = EORImag8 %0, %1
# CHECK-NEXT: RTS
...
---
name: ldcimm
# CHECK-LABEL: name: ldcimm
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = G_CONSTANT i1 true
    RTS implicit %0
# CHECK:      %0:cc = LDCImm -1
# CHECK-NEXT: RTS
...
---
name: ldimm
# CHECK-LABEL: name: ldimm
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = G_CONSTANT i8 42
    RTS implicit %0
# CHECK:      %0:gpr = LDImm 42
...
---
name: load
# CHECK-LABEL: name: load
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:imag16(p0) = COPY $rs1
    %1:any(s8) = G_LOAD %0:imag16(p0) :: (load 1)
    RTS implicit %1
# CHECK:      %2:yc = LDImm 0
# CHECK-NEXT: %1:ac = LDYIndir %0, %2
# CHECK-NEXT: RTS
...
---
name: load_indexed_indir
# CHECK-LABEL: name: load
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(p0) = COPY $rs1
    %1:any(s8) = G_CONSTANT i8 -1
    %2:any(p0) = G_PTR_ADD %0, %1
    %3:any(s8) = G_LOAD %2 :: (load 1)
    RTS implicit %3
# CHECK:      %0:imag16 = COPY $rs1
# CHECK-NEXT: %1:yc = LDImm -1
# CHECK-NEXT: %3:ac = LDYIndir %0, %1
# CHECK-NEXT: RTS
...
---
name: ora
# CHECK-LABEL: name: ora
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(s8) = COPY $a
    %2:any(s8) = G_OR %0, %1
    RTS implicit %2
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %1:imag8 = COPY $a
# CHECK-NEXT: %2:ac = ORAImag8 %0, %1
# CHECK-NEXT: RTS
...
---
name: rol
# CHECK-LABEL: name: rol
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s1) = COPY $v
    %2:any(s8), %3:any(s1) = G_SHLE %0, %1
    RTS implicit %2, implicit %3
# CHECK:      %0:aimag8 = COPY $a
# CHECK-NEXT: %1:cc = COPY $v
# CHECK-NEXT: %2:aimag8, %3:cc = ROL %0, %1
# CHECK-NEXT: RTS
...
---
name: rol_1
# CHECK-LABEL: name: rol_1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s1) = G_CONSTANT i1 1
    %2:any(s8), %3:any(s1) = G_SHLE %0, %1
    RTS implicit %2, implicit %3
# CHECK:      %0:aimag8 = COPY $a
# CHECK-NEXT: %1:cc = LDCImm -1
# CHECK-NEXT: %2:aimag8, %3:cc = ROL %0, %1
# CHECK-NEXT: RTS
...
---
name: select_i1
# CHECK-LABEL: name: select_i1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = COPY $c
    %1:any(s1) = COPY $c
    %2:any(s1) = COPY $v
    %3:any(s1) = G_SELECT %0, %1, %2
    RTS implicit %3
# CHECK:      %3:anyi1 = Select %0, %1, %2
# CHECK-NEXT: RTS
...
---
name: select_i8
# CHECK-LABEL: name: select_i8
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s1) = COPY $c
    %1:any(s8) = COPY $a
    %2:any(s8) = COPY $x
    %3:any(s8) = G_SELECT %0, %1, %2
    RTS implicit %3
# CHECK:      %3:anyi8 = Select %0, %1, %2
# CHECK-NEXT: RTS
...
---
name: store
# CHECK-LABEL: name: store
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(p0) = COPY $rs1
    G_STORE %0, %1 :: (store 1)
    RTS
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %1:imag16 = COPY $rs1
# CHECK-NEXT: %2:yc = LDImm 0
# CHECK-NEXT: STYIndir %0, %1, %2
# CHECK-NEXT: RTS
...
---
name: trunc_8_1
# CHECK-LABEL: name: trunc_8_1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $a
    %1:any(s1) = G_TRUNC %0
    RTS implicit %1
# CHECK:      %2:anyi1 = COPY %0.sublsb
# CHECK-NEXT: RTS implicit %2
...
---
name: trunc_16_8
# CHECK-LABEL: name: trunc_16_8
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s16) = COPY $rs1
    %1:any(s8) = G_TRUNC %0
    RTS implicit %1
# CHECK:      %2:anyi8 = COPY %0.sublo
# CHECK-NEXT: RTS implicit %2
...
---
name: trunc_16_1
# CHECK-LABEL: name: trunc_16_1
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s16) = COPY $rs1
    %1:any(s1) = G_TRUNC %0
    RTS implicit %1
# CHECK:      %2:anyi8 = COPY %0.sublo
# CHECK-NEXT: %3:anyi1 = COPY %2.sublsb
# CHECK-NEXT: RTS implicit %3
...
---
name: uadde_imm
# CHECK-LABEL: name: uadde_imm
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(s8) = G_CONSTANT i8 42
    %2:any(s1) = COPY $v
    %3:any(s8), %4:any(s1) = G_UADDE %0:any(s8), %1:any(s8), %2:any(s1)
    RTS implicit %3, implicit %4
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %2:cc = COPY $v
# CHECK-NEXT: %3:ac, %4:cc, %5:vc = ADCImm %0, 42, %2
# CHECK-NEXT: RTS
...
---
name: uadde
# CHECK-LABEL: name: uadde
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %0:any(s8) = COPY $x
    %1:any(s8) = COPY $a
    %2:any(s1) = COPY $v
    %3:any(s8), %4:any(s1) = G_UADDE %0:any(s8), %1:any(s8), %2:any(s1)
    RTS implicit %3, implicit %4
# CHECK:      %0:ac = COPY $x
# CHECK-NEXT: %1:imag8 = COPY $a
# CHECK-NEXT: %2:cc = COPY $v
# CHECK-NEXT: %3:ac, %4:cc, %5:vc = ADCImag8 %0, %1, %2
# CHECK-NEXT: RTS
...
---
name: unmerge
# CHECK-LABEL: name: unmerge
legalized: true
regBankSelected: true
body: |
  bb.0.entry:
    %1:any(s8), %2:any(s8) = G_UNMERGE_VALUES %0:imag16(s16)
    RTS implicit %1, implicit %2
# CHECK:      %0:anyi8 = COPY %2.sublo
# CHECK-NEXT: %1:anyi8 = COPY %2.subhi
...
