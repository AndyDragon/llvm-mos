# RUN: llc -mtriple=mos -run-pass=postrapseudos -verify-machineinstrs -o - %s | FileCheck %s
---
name: incsp
# CHECK-LABEL: name: incsp
body: |
  bb.0.entry:
    IncSP -1234, implicit $rs0, implicit-def $rs0
    RTS
# CHECK:      $c = LDCimm 0
# CHECK-NEXT: $a = LDimm 46
# CHECK-NEXT: $a, $c = ADCimag8 $a, $rc0, $c
# CHECK-NEXT: $rc0 = STimag8 $a
# CHECK-NEXT: $a = LDimm 251
# CHECK-NEXT: $a, dead $c = ADCimag8 $a, $rc1, $c
# CHECK-NEXT: $rc1 = STimag8 $a
...
---
name: incsp_hi_only
# CHECK-LABEL: name: incsp
body: |
  bb.0.entry:
    IncSP -512, implicit $rs0, implicit-def $rs0
    RTS
# CHECK:      $c = LDCimm 0
# CHECK-NEXT: $a = LDimm 254
# CHECK-NEXT: $a, dead $c = ADCimag8 $a, $rc1, $c
# CHECK-NEXT: $rc1 = STimag8 $a
...
---
name: ldaidx
# CHECK-LABEL: name: ldaidx
body: |
  bb.0.entry:
    liveins: $x
    $a = LDidx 1234, $x, implicit-def $nz
# CHECK: LDAidx 1234, $x
...
---
name: ldxidx_y
# CHECK-LABEL: name: ldxidx_y
body: |
  bb.0.entry:
    liveins: $y
    $x = LDidx 1234, $y, implicit-def $nz
# CHECK: LDXidx 1234
...
---
name: ldxidx_x
# CHECK-LABEL: name: ldxidx_x
body: |
  bb.0.entry:
    liveins: $x
    $x = LDidx 1234, $x, implicit-def $nz
    CMPimm $a, 0, implicit-def $c, implicit-def $nz
# CHECK:      STabs $a, &_SaveA
# CHECK-NEXT: LDAidx 1234, $x
# CHECK-NEXT: $x = TA_
# CHECK-NEXT: PHP
# CHECK-NEXT: $a = LDabs &_SaveA
# CHECK-NEXT: PLP
...
---
name: ldyidx_x
# CHECK-LABEL: name: ldyidx_x
body: |
  bb.0.entry:
    liveins: $x
    $y = LDidx 1234, $x, implicit-def $nz
# CHECK: LDYidx 1234
...
